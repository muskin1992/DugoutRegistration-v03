<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é ç´„ç™»è¨˜ç³»çµ±</title>
    <style>
        body {
            font-family: 'Microsoft JhengHei', 'å¾®è»Ÿæ­£é»‘é«”', 'PingFang TC', 'Heiti TC', Arial, sans-serif;
            max-width: 960px;
            margin: 0 auto;
            padding: 16px;
            background-color: #f5f5f5;
            font-size: 16px;
            line-height: 1.5;
        }
        .container {
            background-color: white;
            padding: 16px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 24px;
            font-size: 24px;
            font-weight: bold;
        }
        .form-group {
            margin-bottom: 16px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: bold;
            font-size: 16px;
        }
        select, input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            margin-bottom: 12px;
            background-color: white;
            cursor: pointer;
            box-sizing: border-box;
        }
        select:hover, input:hover {
            border-color: #999;
        }
        select:focus, input:focus {
            outline: none;
            border-color: #4CAF50;
            box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.2);
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            width: 100%;
            font-size: 16px;
            margin-top: 16px;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #45a049;
        }
        button[style*="background-color: #2196F3"]:hover {
            background-color: #1976D2;
        }
        #result {
            margin-top: 16px;
            padding: 16px;
            border: 2px solid #ddd;
            border-radius: 8px;
            display: none;
            background-color: #f9f9f9;
        }
        .price {
            font-size: 24px;
            color: #4CAF50;
            font-weight: bold;
            text-align: center;
            margin: 12px 0;
        }
        .price-detail {
            margin: 12px 0;
            padding: 12px;
            background-color: white;
            border-radius: 8px;
            font-size: 16px;
        }
        .price-detail div {
            margin: 8px 0;
            line-height: 1.6;
        }
        .hint {
            color: #666;
            font-size: 14px;
            margin-bottom: 8px;
        }
        .payment-info {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin: 12px 0;
            padding: 12px;
            background-color: #f5f5f5;
            border-radius: 8px;
        }
        .payment-info span {
            font-weight: bold;
        }
        @media screen and (min-width: 768px) {
            body {
                padding: 24px;
                font-size: 18px;
            }
            .container {
                padding: 24px;
            }
            h1 {
                font-size: 32px;
                margin-bottom: 36px;
            }
            label {
                font-size: 20px;
            }
            select, input {
                font-size: 18px;
            }
            button {
                font-size: 20px;
                padding: 16px 32px;
            }
            .price {
                font-size: 32px;
            }
            .price-detail {
                font-size: 18px;
            }
            .hint {
                font-size: 16px;
            }
            .payment-info {
                flex-direction: row;
                justify-content: space-between;
            }
        }
    </style>
</head>
<body>
    <div class="container">
    <h1>é ç´„ç™»è¨˜ç³»çµ±</h1>
    <div class="form-group">
        <label>å§“åï¼š</label>
        <input type="text" id="customerName" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 18px; margin-bottom: 12px;" placeholder="è«‹è¼¸å…¥å§“å">
    </div>
    <div class="form-group">
        <label>é–‹å§‹æ™‚é–“ï¼š</label>
            <select id="startYear" required></select>
            <select id="startMonth" required></select>
            <select id="startDay" required></select>
            <select id="startHour" required></select>
            <select id="startMinute" required></select>
    </div>
    <div class="form-group">
        <label>çµæŸæ™‚é–“ï¼š</label>
            <select id="endYear" required></select>
            <select id="endMonth" required></select>
            <select id="endDay" required></select>
            <select id="endHour" required></select>
            <select id="endMinute" required></select>
    </div>
    <div class="form-group">
        <label>å¹¾ä½æˆäºº?</label>
        <select id="peopleCount" required>
            <option value="">è«‹é¸æ“‡äººæ•¸</option>
            <option value="3">3äºº</option>
            <option value="4">4äºº</option>
            <option value="5">5äºº</option>
            <option value="6">6äºº</option>
            <option value="7">7äºº</option>
            <option value="8">8äºº</option>
            <option value="9">9äºº</option>
            <option value="10">10äºº</option>
            <option value="11">11äºº</option>
            <option value="12">12äºº</option>
            <option value="13">13äºº</option>
            <option value="14">14äºº</option>
            <option value="15">15äºº</option>
            <option value="16">16äºº</option>
            <option value="17">17äºº</option>
            <option value="18">18äºº</option>
        </select>
    </div>
    <div class="form-group">
        <label>å¹¾ä½1~6æ­²å­©ç«¥?</label>
        <select id="childCount" required>
            <option value="0">0ä½</option>
            <option value="1">1ä½</option>
            <option value="2">2ä½</option>
            <option value="3">3ä½</option>
            <option value="4">4ä½</option>
            <option value="5">5ä½</option>
            <option value="6">6ä½</option>
            <option value="7">7ä½</option>
            <option value="8">8ä½</option>
            <option value="9">9ä½</option>
            <option value="10">10ä½</option>
            <option value="11">11ä½</option>
            <option value="12">12ä½</option>
            <option value="13">13ä½</option>
            <option value="14">14ä½</option>
            <option value="15">15ä½</option>
            <option value="16">16ä½</option>
        </select>
    </div>
    <button onclick="calculatePrice()">è©¦ç®—å…¥å ´è²»</button>
    <div id="priceResult" style="display: none;">
        <div class="price-detail" style="margin-bottom: 20px; padding: 15px; background-color: #e8e8e8; border-radius: 8px; line-height: 1.8;">
            <div>æ‚¨å¥½ï¼Œå‘æ‚¨ç¢ºèªè¨‚ä½è³‡è¨Šï¼Œæ‚¨çš„é ç´„æª”æœŸç‚ºï¼š</div>
            <div style="white-space: pre-line; margin: 10px 0;"><br></div>
            <div id="customerNameConfirm" style="margin: 10px 0;"></div>
            <div id="timeRangeConfirm" style="margin: 10px 0;"></div>
            <div id="durationConfirm" style="margin: 10px 0;"></div>
            <div style="white-space: pre-line; margin: 10px 0;"><br></div>
            <div style="margin: 10px 0;">è«‹å•æ˜¯å¦æ­£ç¢ºå‘¢?</div>
            <div style="white-space: pre-line; margin: 10px 0;"><br></div>
            <div style="margin: 10px 0;">æ­£ç¢ºçš„è©±å†è«‹æ–¼å…©å¤©å…§</div>
            <div style="margin: 10px 0;">åŒ¯æ¬¾ã€Œ$500å…ƒ å®šé‡‘ã€ä¿ç•™æª”æœŸå“¦ï¼</div>
            <div style="white-space: pre-line; margin: 10px 0;"><br></div>
            <div style="margin: 10px 0;">åŒ¯æ¬¾æ–¹å¼: ä¸­è¯éƒµæ”¿ï¼ˆ700)ã€€00214550195600</div>
            <div style="white-space: pre-line; margin: 10px 0;"><br></div>
            <div style="margin: 10px 0;">ğŸŒŸæ²’è¾¦æ³•è½‰è³¬ï¼šæ‰¾éƒµå±€ATMï¼Œé»é¸ã€Œç„¡å¡å­˜æ¬¾ã€ï¼Œè¼¸å…¥æˆ‘å€‘ç›¸å°æ‡‰çš„å¸³è™Ÿå¾Œé€²è¡Œå­˜æ¬¾ï¼Œå®Œæˆå¾Œè¨˜å¾—æ‹æ”¶æ“šæˆ–æˆªåœ–çµ¦å°å¹«æ‰‹</div>
            <div style="white-space: pre-line; margin: 10px 0;"><br></div>
            <div style="margin: 10px 0; color: #ff4444;">âš ï¸æé†’æ‚¨ï¼Œå®šé‡‘åŒ¯æ¬¾å®Œæˆå¾Œï¼Œå°‡ä¸å¾—åšä»»ä½•æ›´æ”¹ï¼ŒåŒ…æ‹¬ã€Œå–æ¶ˆ+é€€è²»ã€ã€ã€Œæ”¹æœŸã€ã€ã€Œç¸®çŸ­æ™‚é–“ã€ã€ã€Œæ›´æ”¹å ´åœ°ã€ã€‚è‹¥ç©å®¶æœªå¦‚æœŸæŠµé”ï¼Œä¿ç•™æª”æœŸçš„$500å®šé‡‘ä¸å¾—è¿”é‚„æˆ–æ”¹æœŸã€‚</div>
        </div>
        <div class="price-detail" style="margin-bottom: 20px; padding: 15px; background-color: #e8e8e8; border-radius: 8px; line-height: 1.8;">
            <div style="margin: 10px 0;">ç•¶å¤©å…¥å ´å‰ä¸€å€‹å°æ™‚ï¼Œæ”¯ä»˜<span id="pricePerPersonConfirm">0</span>Ã—äººæ•¸+<span id="depositMinusDownConfirm">0</span>ï¼ˆç¸½å…¥å ´è²»+æŠ¼é‡‘å°¾æ¬¾ï¼‰ï¼Œå°±æœƒçµ¦æ‚¨é›»å­é–çš„å¯†ç¢¼ã€‚</div>
            <div style="margin: 10px 0;"><br></div>
            <div style="margin: 10px 0;">ç„¶å¾Œé€²å ´å¾ŒæœƒæŠ½ä¸€å€‹æŠ˜æ‰£æ‰­è›‹ï¼Œè£¡é¢æœƒæœ‰æ‰“æŠ˜çš„å„ªæƒ ï¼Œå†æ‹ç…§çµ¦æˆ‘~</div>
            <div style="margin: 10px 0;"><br></div>
            <div>æ‚¨å€‘éŠç©çµæŸé›¢å ´å¾Œï¼Œæˆ‘å€‘å»æ•´ç†å®Œï¼Œå°±æœƒæŠŠ<span id="depositRefundConfirm">0</span>å…ƒ(å®š+æŠ¼é‡‘)ï¼Œä»¥åŠæŠ˜æ‰£å¾Œçš„å·®åƒ¹ä¸€èµ·é€€é‚„çµ¦æ‚¨ğŸ‰</div>
        </div>
        <div class="price-detail" style="margin-bottom: 20px; padding: 15px; background-color: #e8e8e8; border-radius: 8px; line-height: 1.8;">
            <div style="margin: 10px 0;">æ²’å•é¡Œçš„è©±ï¼Œè½‰å®Œå®šé‡‘å†è¨˜å¾—è·Ÿæˆ‘èªªä¸€ä¸‹æœ«äº”ç¢¼</div>
        </div>
        <div class="price-detail" style="margin-bottom: 20px; padding: 15px; background-color: #e8e8e8; border-radius: 8px; line-height: 1.8;">
            <div style="margin: 10px 0;">æ‚¨å¥½ï¼Œå·²æ”¶å–500å…ƒå®šé‡‘ï¼Œç‚ºæ‚¨ä¿ç•™æª”æœŸï¼Œè¨˜å…¥æœ¬åº—é ç´„è¡Œäº‹æ›†ï¼Œæ„Ÿè¬æ‚¨é ç´„å˜»é¬§é˜²ç©ºæ´ğŸ‰</div>
            <div style="margin: 10px 0;"><br></div>
            <div id="reservationDateConfirm" style="margin: 10px 0;"></div>
            <div id="reservationTimeConfirm" style="margin: 10px 0;"></div>
            <div style="margin: 10px 0;">åœ°é»ï¼šå°ä¸­å¸‚ä¸­å€æˆåŠŸè·¯10è™Ÿ3æ¨“Bå®¤(å¼˜çˆºæ¼¢å ¡ç«ç®­åº—æ—é‚Šçš„é›»æ¢¯ä¸Š3æ¨“ï¼Œå‡ºé›»æ¢¯å³æ‰‹é‚Š)</div>
            <div style="margin: 10px 0;"><br></div>
            <div style="margin: 10px 0;">ğŸ“¢å®¤å…§å ´åœ°å…¥å…§è«‹è„«é‹~</div>
            <div style="margin: 10px 0;"><br></div>
            <div style="margin: 10px 0; color: #ff4444;">âš ï¸æé†’æ‚¨ï¼Œå®šé‡‘åŒ¯æ¬¾å®Œæˆå¾Œï¼Œå°‡ä¸å¾—åšä»»ä½•æ›´æ”¹ï¼ŒåŒ…æ‹¬ã€Œå–æ¶ˆ+é€€è²»ã€ã€ã€Œæ”¹æœŸã€ã€ã€Œç¸®çŸ­æ™‚é–“ã€ã€ã€Œæ›´æ”¹å ´åœ°ã€ã€‚è‹¥ç©å®¶æœªå¦‚æœŸæŠµé”ï¼Œä¿ç•™æª”æœŸçš„$500å®šé‡‘ä¸å¾—è¿”é‚„æˆ–æ”¹æœŸã€‚</div>
            <div style="margin: 10px 0;"><br></div>
            <div style="margin: 10px 0; color: #4CAF50;">âœ…å ´å…§è¨­æœ‰24Hç›£æ§ï¼Œã€Œäººæ•¸è‹¥æœ‰æ›´æ”¹è«‹å‹™å¿…å‘ŠçŸ¥ã€ï¼Œé¿å…å½±éŸ¿å€‹äººæ¬Šç›Š</div>
            <div style="margin: 10px 0;"><br></div>
            <div style="margin: 10px 0;">-è²¼å¿ƒå‘ŠçŸ¥-</div>
            <div style="margin: 10px 0;">å ´å…§å¸è¸ï¼ˆåŒ…æ‹¬é›»å­ç…™ï¼‰ï¼šæŠ¼é‡‘å…¨æ‰£</div>
            <div style="margin: 10px 0;">å®¤å…§å˜”åã€å¤§é«’æ±™æ²’æ¸…(20CM*20CM)ï¼šæ‰£$1000æŠ¼é‡‘ä½œç‚ºæ¸…æ½”è²»ï¼Œå‰©é¤˜è¿”é‚„</div>
        </div>
        <div class="price-detail" style="margin-bottom: 20px; padding: 15px; background-color: #e8e8e8; border-radius: 8px; line-height: 1.8;">
            <div style="margin: 10px 0;">æ„Ÿè¬é ç´„ï¼ŒæœŸå¾…æ‚¨çš„å…‰è‡¨ï¼ğŸ•¹ï¸ğŸ‘¾ğŸ¯</div>
            <button onclick="confirmDeposit()" style="background-color: #FF9800; margin-top: 10px;">ç™»è¨˜å®šé‡‘</button>
        </div>
        <div class="price-detail" style="margin-bottom: 20px; padding: 15px; background-color: #e8e8e8; border-radius: 8px; line-height: 1.8;">
            <div>æ‚¨å¥½ï¼Œæé†’æ‚¨ï¼Œä»Šå¤©<span id="reminderStartTime">14ï¼š30</span>æœ‰é ç´„éŠç©å ´åœ°ï¼Œå†è«‹è¨˜å¾—æ–¼é ç´„æ™‚é–“å‰åŒ¯æ¬¾å“¦ï¼</div>
            <div style="margin: 10px 0;"><br></div>
            <div style="margin: 10px 0;">é‡‘é¡æ˜¯<span id="reminderPricePerPerson">0</span>å…ƒÃ—äººæ•¸+<span id="reminderDepositMinusDown">0</span>å…ƒï¼ˆç¸½å…¥å ´è²»+æŠ¼é‡‘å°¾æ¬¾ï¼‰ï¼Œå¯†ç¢¼æœƒåœ¨å…¥å ´å‰ååˆ†é˜å‚³é€~</div>
            <div style="margin: 10px 0;">éå¸¸æ„Ÿè¬ğŸ¿</div>
        </div>
        <div class="price-detail" style="margin-bottom: 20px; padding: 15px; background-color: #e8e8e8; border-radius: 8px; line-height: 1.8;">
            <div>æ‚¨å¥½ï¼š</div>
            <div style="margin: 10px 0;">æ¬¾é …å·²ç¢ºèªä»˜æ¸…ï¼Œæ—…ç¨‹å³å°‡é–‹å§‹ï¼Œå¯†ç¢¼ä¾†å›‰ğŸ‰</div>
            <div style="margin: 10px 0;"><br></div>
            <div id="playTimeConfirm" style="margin: 10px 0;"></div>
            <div style="margin: 10px 0;">âœ…åœ°é»ï¼šå°ä¸­å¸‚ä¸­å€æˆåŠŸè·¯10è™Ÿ3æ¨“Bå®¤(ç›´æ¥æ­é›»æ¢¯åˆ°ä¸‰æ¨“)</div>
            <div style="margin: 10px 0;"><br></div>
            <div style="margin: 10px 0;">âœ…é›»å­é–å¯†ç¢¼:</div>
            <div style="margin: 10px 0;">âé›»å­é–ä½¿ç”¨æ–¹å¼ï¼šè§¸æ‘¸ä¸€ä¸‹é¢æ¿ï¼Œè¼¸å…¥å¯†ç¢¼å¾Œå†ã€ŒæŒ‰ï¼ƒå­—éµã€å°±å¯ä»¥å›‰ï¼</div>
            <div style="margin: 10px 0;">*ä¸è¦æ‘¸æŒ‡ç´‹é–çš„åœ°æ–¹å–”ï¼æœƒé–ä½~</div>
            <div style="margin: 10px 0;"><br></div>
            <div style="margin: 10px 0;">âœ…å¯†ç¢¼æœ‰æ•ˆæœŸï¼š</div>
            <div id="passwordStartTime" style="margin: 10px 0;">2025-04-16 15ï¼š50  è‡³</div>
            <div id="passwordEndTime" style="margin: 10px 0;">2025-04-16 19ï¼š00</div>
            <div style="margin: 10px 0;"><br></div>
            <div style="margin: 10px 0;">éŠç©æ™‚é–“çµæŸå¾Œï¼Œé€—ç•™å ´åœ°è¶…é10åˆ†é˜ä»¥ä¸Šï¼Œæœƒä»¥æ¯åŠå°æ™‚è¨ˆç®—ä¾†æ”¶å–å ´åœ°ç§Ÿé‡‘ã€‚</div>
            <div style="margin: 10px 0;"><br></div>
            <div style="margin: 10px 0;">é€€æˆ¿å‰è«‹å¹«å¹«å°å¹«æ‰‹:</div>
            <div style="margin: 10px 0;">é—œé–‰é›»å™¨ã€é—œé›»ç‡ˆï¼Œé—œå†·æ°£ï¼Œé—œè¡—æ©Ÿï¼Œé—œéŸ³æ¨‚æ©Ÿï¼Œå°‡é–€ç¢ºå¯¦é—”ä¸Šã€‚</div>
            <div style="margin: 10px 0;">æ„Ÿè¬æ‚¨çš„é…åˆï¼Œç¥æ‚¨é˜²ç©ºæ´ä¹‹æ—…æ¢éšªæ„‰å¿«ï¼â¤ï¸</div>
        </div>
        <div class="price-detail" style="margin-bottom: 20px; padding: 15px; background-color: #e8e8e8; border-radius: 8px; line-height: 1.8;">
            <div style="margin: 10px 0;">å¾…æœƒç”¨é€™å€‹å¯†ç¢¼å°±å¯ä»¥é€²å»å›‰ï¼</div>
            <div style="margin: 10px 0;">æ©Ÿå°çš„ä½¿ç”¨èªªæ˜éƒ½åœ¨æ¡Œä¸Šçš„ç´™è£¡ï¼Œéº»å°‡æ¡Œçš„åœ¨æ—é‚Šçš„ç‰†å£ä¸Šï¼Œæœ‰å•é¡Œå†å•æˆ‘~</div>
        </div>
        <div class="price-detail" style="margin-bottom: 20px; padding: 15px; background-color: #e8e8e8; border-radius: 8px; line-height: 1.8;">
            <div style="margin: 10px 0;">å…¥å ´è¨˜å¾—è„«é‹å­å–”ï¼</div>
            <div style="margin: 10px 0;">éå¸¸æ„Ÿè¬</div>
        </div>
        <button onclick="confirmFinalPayment()" style="background-color: #FF9800; margin-top: 10px;">ç™»è¨˜å°¾æ¬¾</button>
        <div class="price">å°¾æ¬¾åŒ¯æ¬¾é‡‘é¡(ç¸½å…¥å ´è²»+æŠ¼é‡‘å°¾æ¬¾)ï¼š<span id="totalPrice">0</span> å…ƒ</div>
        <div class="price-detail">
            <div>æ™‚æ®µï¼š<span id="timeRange" style="user-select: all;">-</span></div>
            <div>æ–¹æ¡ˆï¼š<span id="timeSlot">-</span></div>
            <div>é ç´„æ™‚æ•¸ï¼š<span id="duration">0</span> å°æ™‚</div>
            <div>æ¯äººå…¥å ´è²»ï¼š<span id="pricePerPerson">0</span> å…ƒ</div>
            <div>ç¸½å…¥å ´è²»ï¼š<span id="priceFormula">-</span> = <span id="totalAdmission">0</span> å…ƒ</div>
            <div class="payment-info">
                <span>å®šé‡‘ï¼š500 å…ƒ</span>
                <span>æˆäººæŠ¼é‡‘(å«å®šé‡‘)ï¼š<span id="deposit">0</span> å…ƒ</span>
                <span>å…’ç«¥æŠ¼é‡‘ï¼š<span id="childDeposit">0</span> å…ƒ</span>
                <span>å°¾æ¬¾åŒ¯æ¬¾é‡‘é¡(ç¸½å…¥å ´è²»+æŠ¼é‡‘å°¾æ¬¾)ï¼š<span id="finalPayment">0</span> å…ƒ</span>
            </div>
        </div>
    </div>
    <div class="form-group">
        <label>æ‰­è›‹æŠ˜æ•¸ï¼š</label>
        <select id="discountRate" required>
            <option value="1">ç„¡æŠ˜æ‰£</option>
            <option value="0.7">7æŠ˜</option>
            <option value="0.75">75æŠ˜</option>
            <option value="0.8">8æŠ˜</option>
            <option value="0.85">85æŠ˜</option>
            <option value="0.9">9æŠ˜</option>
            <option value="0.95">95æŠ˜</option>
        </select>
    </div>
    <button onclick="calculateRefund()" style="background-color: #2196F3;">è©¦ç®—é€€æ¬¾é‡‘é¡</button>
    <div id="refundResult" style="display: none;">
        <div class="price-detail">
            <div>æŠ˜å‰é‡‘é¡ï¼š<span id="originalAmount">0</span> å…ƒ</div>
            <div>æŠ˜å¾Œé‡‘é¡ï¼š<span id="discountedAmount">0</span> å…ƒ</div>
            <div>æ‰­è›‹æŠ˜æ‰£å¾Œå·®é¡ï¼š<span id="discountDifference">0</span> å…ƒ</div>
            <div>ç¸½æŠ¼é‡‘(å«å®šé‡‘)ï¼š<span id="depositAndDown">0</span> å…ƒ</div>
            <div class="price">é€€æ¬¾ç¸½é¡(å·®é¡+æŠ¼å®šé‡‘)ï¼š<span id="refundAmount">0</span> å…ƒ</div>
            <button onclick="confirmRefund()" style="background-color: #FF9800; margin-top: 10px;">ç™»è¨˜é€€æ¬¾</button>
        </div>
    </div>
    </div>

    <script>
        // å‡æ—¥åˆ—è¡¨
        const holidays = {
            '2024': {
                '1': {
                    '1': 'å…ƒæ—¦',
                    '2': 'å…ƒæ—¦è£œå‡'
                },
                '2': {
                    '8': 'å°å¹´å¤œ',
                    '9': 'é™¤å¤•',
                    '10': 'æ˜¥ç¯€',
                    '11': 'æ˜¥ç¯€',
                    '12': 'æ˜¥ç¯€',
                    '13': 'æ˜¥ç¯€',
                    '14': 'æ˜¥ç¯€',
                    '28': '228ç´€å¿µæ—¥'
                },
                '3': {
                    '1': '228ç´€å¿µæ—¥è£œå‡'
                },
                '4': {
                    '4': 'å…’ç«¥ç¯€',
                    '5': 'æ¸…æ˜ç¯€'
                },
                '5': {
                    '1': 'å‹å‹•ç¯€'
                },
                '6': {
                    '10': 'ç«¯åˆç¯€'
                },
                '9': {
                    '17': 'ä¸­ç§‹ç¯€'
                },
                '10': {
                    '10': 'åœ‹æ…¶æ—¥',
                    '11': 'åœ‹æ…¶æ—¥è£œå‡'
                },
                '12': {
                    '25': 'è¡Œæ†²ç´€å¿µæ—¥'
                }
            },
            '2025': {
                '1': {
                    '1': 'å…ƒæ—¦'
                },
                '2': {
                    '28': '228ç´€å¿µæ—¥'
                },
                '4': {
                    '4': 'å…’ç«¥ç¯€',
                    '5': 'æ¸…æ˜ç¯€'
                },
                '5': {
                    '1': 'å‹å‹•ç¯€'
                },
                '6': {
                    '10': 'ç«¯åˆç¯€'
                },
                '9': {
                    '17': 'ä¸­ç§‹ç¯€'
                },
                '10': {
                    '10': 'åœ‹æ…¶æ—¥'
                },
                '12': {
                    '25': 'è¡Œæ†²ç´€å¿µæ—¥'
                }
            }
        };

        // åˆå§‹åŒ–å‡æ—¥åˆ—è¡¨
        function initializeHolidays() {
            const currentYear = new Date().getFullYear();
            const nextYear = currentYear + 1;
            
            // ç¢ºä¿ç•¶å‰å¹´ä»½å’Œä¸‹ä¸€å¹´çš„å‡æ—¥åˆ—è¡¨å­˜åœ¨
            if (!holidays[currentYear]) {
                holidays[currentYear] = {};
            }
            if (!holidays[nextYear]) {
                holidays[nextYear] = {};
            }
        }

        // åœ¨é é¢è¼‰å…¥æ™‚åˆå§‹åŒ–å‡æ—¥åˆ—è¡¨
        window.onload = function() {
            initializeHolidays();
            // ç²å–ç•¶å‰æ—¥æœŸ
            const now = new Date();
            const currentYear = now.getFullYear();
            const currentMonth = now.getMonth() + 1;
            const currentDay = now.getDate();
            const currentHour = now.getHours();
            const currentMinute = now.getMinutes();
            const roundedMinute = currentMinute >= 30 ? 30 : 0;

            // åˆå§‹åŒ–æ™‚é–“é¸å–®
            function initializeTimeSelects() {
                // å¹´ä»½é¸å–®
                ['startYear', 'endYear'].forEach(id => {
                    const select = document.getElementById(id);
                    select.innerHTML = '<option value="">é¸æ“‡å¹´ä»½</option>';
                    const currentYear = new Date().getFullYear();
                    select.add(new Option(currentYear + 'å¹´', currentYear));
                    select.add(new Option((currentYear + 1) + 'å¹´', currentYear + 1));
                    select.value = currentYear;
                });

                // æœˆä»½é¸å–®
                ['startMonth', 'endMonth'].forEach(id => {
                    const select = document.getElementById(id);
                    select.innerHTML = '<option value="">é¸æ“‡æœˆä»½</option>';
                    for (let i = 1; i <= 12; i++) {
                        select.add(new Option(i + 'æœˆ', i));
                    }
                    select.value = currentMonth;
                });

                // æ—¥æœŸé¸å–®
                ['startDay', 'endDay'].forEach(id => {
                    const select = document.getElementById(id);
                    select.innerHTML = '<option value="">é¸æ“‡æ—¥æœŸ</option>';
                    const daysInMonth = new Date(currentYear, currentMonth, 0).getDate();
                    for (let i = 1; i <= daysInMonth; i++) {
                        select.add(new Option(i + 'æ—¥', i));
                    }
                    select.value = currentDay;
                });

                // å°æ™‚é¸å–®
                ['startHour', 'endHour'].forEach(id => {
                    const select = document.getElementById(id);
                    select.innerHTML = '<option value="">é¸æ“‡æ™‚</option>';
                    for (let i = 0; i <= 23; i++) {
                        select.add(new Option(i + 'æ™‚', i));
                    }
                    select.value = currentHour;
                });

                // åˆ†é˜é¸å–®
                ['startMinute', 'endMinute'].forEach(id => {
                    const select = document.getElementById(id);
                    select.innerHTML = '<option value="">é¸æ“‡åˆ†</option>';
                    select.add(new Option('0åˆ†', '0'));
                    select.add(new Option('30åˆ†', '30'));
                    select.value = '0';
                });
            }

            // åˆå§‹åŒ–æ‰€æœ‰é¸å–®
            initializeTimeSelects();

            // ç¶å®šäº‹ä»¶ç›£è½å™¨
            ['start', 'end'].forEach(prefix => {
                document.getElementById(prefix + 'Year').addEventListener('change', () => updateDays(prefix));
                document.getElementById(prefix + 'Month').addEventListener('change', () => updateDays(prefix));
            });

            // åˆå§‹åŒ–æ—¥æœŸé¸å–®
            updateDays('start');
            updateDays('end');

            // äººæ•¸é¸å–®
            const peopleSelect = document.getElementById('peopleCount');
            peopleSelect.innerHTML = '<option value="">è«‹é¸æ“‡äººæ•¸</option>';
            for (let i = 3; i <= 18; i++) {
                peopleSelect.add(new Option(i + 'äºº', i));
            }
            peopleSelect.value = '';

            // ç§»é™¤æ‰‹å‹•è¼¸å…¥äººæ•¸çš„äº‹ä»¶ç›£è½
            const manualPeopleCount = document.getElementById('childCount');
            manualPeopleCount.addEventListener('change', function() {
                const value = parseFloat(this.value);
                if (value >= 0 && value <= 18) {
                    // ç§»é™¤æ¸…ç©ºæˆäººé¸å–®çš„é‚è¼¯
                }
            });

            peopleSelect.addEventListener('change', function() {
                // ç§»é™¤æ¸…ç©ºå­©ç«¥é¸å–®çš„é‚è¼¯
            });
        }

        // æ›´æ–°æ—¥æœŸé¸å–®çš„å‡½æ•¸
        function updateDays(prefix) {
            const year = document.getElementById(prefix + 'Year').value;
            const month = document.getElementById(prefix + 'Month').value;
            const daySelect = document.getElementById(prefix + 'Day');
            const currentValue = daySelect.value;
            
            daySelect.innerHTML = '<option value="">é¸æ“‡æ—¥æœŸ</option>';
            
            if (year && month) {
                const daysInMonth = new Date(year, month, 0).getDate();
                for (let i = 1; i <= daysInMonth; i++) {
                    const option = new Option(i + 'æ—¥', i);
                    daySelect.add(option);
                }
                
                if (currentValue && currentValue <= daysInMonth) {
                    daySelect.value = currentValue;
                }
            }
        }

        // åˆ¤æ–·æ˜¯å¦ç‚ºå‡æ—¥çš„å‡½æ•¸
        function isHoliday(year, month, day) {
            // å…ˆæª¢æŸ¥æ˜¯å¦ç‚ºé€±æœ«
            const date = new Date(year, month - 1, day);
            const isWeekend = date.getDay() === 0 || date.getDay() === 6;
            
            // å†æª¢æŸ¥æ˜¯å¦ç‚ºåœ‹å®šå‡æ—¥
            const yearHolidays = holidays[year.toString()];
            if (yearHolidays) {
                const monthHolidays = yearHolidays[month.toString()];
                if (monthHolidays && monthHolidays[day.toString()]) {
                    return true;
                }
            }
            
            return isWeekend;
        }

        // è¨ˆç®—åƒ¹æ ¼çš„å‡½æ•¸
        function calculatePrice() {
            const startYear = document.getElementById('startYear').value;
            const startMonth = document.getElementById('startMonth').value;
            const startDay = document.getElementById('startDay').value;
            const startHour = document.getElementById('startHour').value;
            const startMinute = document.getElementById('startMinute').value;
            const endYear = document.getElementById('endYear').value;
            const endMonth = document.getElementById('endMonth').value;
            const endDay = document.getElementById('endDay').value;
            const endHour = document.getElementById('endHour').value;
            const endMinute = document.getElementById('endMinute').value;
            const peopleCountSelect = document.getElementById('peopleCount').value;
            const childCountSelect = document.getElementById('childCount').value;
            const adultCount = peopleCountSelect ? parseFloat(peopleCountSelect) : 0;
            const childCount = childCountSelect ? parseFloat(childCountSelect) : 0;
            const effectivePeopleCount = parseFloat((adultCount + (childCount * 0.8)).toFixed(1));

            // æª¢æŸ¥äººæ•¸æ˜¯å¦å·²é¸æ“‡
            if (!peopleCountSelect) {
                alert('æˆ‘å€‘é ç´„æœ€å°‘éœ€è¦3ä½æˆäººå–”');
                return;
            }

            if (adultCount < 3) {
                alert('æˆ‘å€‘é ç´„æœ€å°‘éœ€è¦3ä½æˆäººå–”');
                return;
            }

            const startDate = new Date(startYear, startMonth - 1, startDay);
            const isWeekend = isHoliday(startYear, startMonth, startDay);

            // æª¢æŸ¥çµæŸæ™‚é–“æ˜¯å¦æ—©æ–¼é–‹å§‹æ™‚é–“
            const startDateTime = new Date(startYear, startMonth - 1, startDay, startHour, startMinute);
            const endDateTime = new Date(endYear, endMonth - 1, endDay, endHour, endMinute);
            
            if (endDateTime <= startDateTime) {
                alert('çµæŸæ™‚é–“å¿…é ˆæ™šæ–¼é–‹å§‹æ™‚é–“');
                return;
            }

            // åˆ¤æ–·æ™‚æ®µé¡å‹
            let timeSlot = '';
            let pricePerPerson = 0;
            let overtimeFee = 0;
            let formula = '';
            let hours = 0;

            // è¨ˆç®—ä½¿ç”¨æ™‚æ•¸
            const hoursDiff = (endDateTime - startDateTime) / (1000 * 60 * 60);
            hours = Math.floor(hoursDiff);
            const minutes = Math.round((hoursDiff - hours) * 60);
            
            if (minutes !== 0 && minutes !== 30) {
                alert('é ç´„æ™‚é•·å¿…é ˆç‚ºæ•´æ•¸å°æ™‚æˆ–åŠå°æ™‚');
                return;
            }

            if (hours < 3) {
                alert('ç¸½é ç´„æ™‚é–“ä¸èƒ½å°æ–¼3å°æ™‚');
                return;
            }

            // å°‡å­—ä¸²è½‰æ›ç‚ºæ•¸å­—
            const startHourNum = parseInt(startHour);
            const startMinuteNum = parseInt(startMinute);
            const endHourNum = parseInt(endHour);
            const endMinuteNum = parseInt(endMinute);

            // å…ˆåˆ¤æ–·æ˜¯å¦ç‚ºå¤§å¤œæ™‚æ®µï¼ˆä»¥é–‹å§‹æ™‚é–“åˆ¤æ–·ï¼‰
            if ((startHourNum === 0 && startMinuteNum === 0) || (startHourNum === 0 && startMinuteNum === 30)) {
                // å¤§å¤œæ™‚æ®µå¿…é ˆé ç´„å®Œæ•´çš„8å°æ™‚
                if ((endHourNum === 8 && endMinuteNum === 0) || (endHourNum === 8 && endMinuteNum === 30)) {
                    timeSlot = isWeekend ? 'å‡æ—¥å¤§å¤œ8å°æ™‚' : 'å¹³æ—¥å¤§å¤œ8å°æ™‚';
                    pricePerPerson = isWeekend ? 680 : 640;
                    formula = `${effectivePeopleCount}*(${isWeekend ? 680 : 640})`;
                    hours = 8;
                } else {
                    alert('æˆ‘å€‘å¤§å¤œæ™‚æ®µè¦é ç´„ä¸€æ•´æ®µ8å°æ™‚å–”ï¼Œ00:00~08:00 æˆ– 00:30~08:30ï¼Œè¬è¬');
                    return;
                }
            }
            // å¦‚æœé–‹å§‹æ™‚é–“åœ¨00:00-08:00ä¹‹é–“ï¼Œä½†ä¸æ˜¯å®Œæ•´çš„å¤§å¤œæ™‚æ®µ
            else if (startHourNum >= 0 && startHourNum < 8) {
                alert('æˆ‘å€‘å¤§å¤œæ™‚æ®µè¦é ç´„ä¸€æ•´æ®µ8å°æ™‚å–”ï¼Œ00:00~08:00 æˆ– 00:30~08:30ï¼Œè¬è¬');
                return;
            }
            // å†åˆ¤æ–·æ˜¯å¦ç‚ºä¸­ç­æ™‚æ®µï¼ˆä»¥é–‹å§‹æ™‚é–“åˆ¤æ–·ï¼‰
            else if (startHourNum >= 16) {
                // ä¸­ç­æ™‚æ®µå¯ä»¥é ç´„åˆ°00:30ä¹‹å‰ï¼Œæˆ–æ˜¯åŒä¸€å¤©å…§çš„ä»»ä½•æ™‚é–“
                if (endHourNum <= 0 || (endHourNum === 0 && endMinuteNum <= 30) || 
                    (startYear === endYear && startMonth === endMonth && startDay === endDay)) {
                    timeSlot = isWeekend ? 'å‡æ—¥ä¸­ç­' : 'å¹³æ—¥ä¸­ç­';
                    if (hours <= 3) {
                        pricePerPerson = (isWeekend ? 450 : 420) * (hours / 3);
                        formula = hours === 3 ? `${effectivePeopleCount}*(${isWeekend ? 450 : 420})` : `${effectivePeopleCount}*(${isWeekend ? 450 : 420}/3*${hours})`;
                        timeSlot += `${hours}å°æ™‚`;
                    } else if (hours === 4) {
                        pricePerPerson = (isWeekend ? 450 : 420) + 80;
                        formula = `${effectivePeopleCount}*(${isWeekend ? 450 : 420}+80)`;
                        timeSlot += '3å°æ™‚+1å°æ™‚åŠ æ™‚';
                    } else if (hours === 5) {
                        pricePerPerson = isWeekend ? 620 : 600;
                        formula = `${effectivePeopleCount}*(${isWeekend ? 620 : 600})`;
                        timeSlot += '5å°æ™‚';
                    } else {
                        const overtimeHours = hours - 5;
                        pricePerPerson = (isWeekend ? 620 : 600) + overtimeHours * 80;
                        formula = `${effectivePeopleCount}*(${isWeekend ? 620 : 600}+${overtimeHours === 1 ? '80' : overtimeHours + '*80'})`;
                        timeSlot += `5å°æ™‚+${overtimeHours}å°æ™‚åŠ æ™‚`;
                    }
                } else {
                    alert('ä¸­ç­æ™‚æ®µçš„çµæŸæ™‚é–“åªèƒ½åœ¨00:30ä¹‹å‰å–”ï¼Œè¬è¬');
                    return;
                }
            }
            // å…¶ä»–æ™‚æ®µï¼ˆç™½å¤©æ™‚æ®µï¼‰
            else if (startHourNum >= 8 && startHourNum < 16) {
                // è¨ˆç®—ä½¿ç”¨æ™‚æ•¸
                const hoursDiff = (endDateTime - startDateTime) / (1000 * 60 * 60);
                hours = Math.floor(hoursDiff);
                const minutes = Math.round((hoursDiff - hours) * 60);
                
                if (minutes !== 0 && minutes !== 30) {
                    alert('é ç´„æ™‚é•·å¿…é ˆç‚ºæ•´æ•¸å°æ™‚æˆ–åŠå°æ™‚');
                    return;
                }

                if (hours < 3) {
                    alert('ç¸½é ç´„æ™‚é–“ä¸èƒ½å°æ–¼3å°æ™‚');
                    return;
                }

                if (hours === 24 && startHourNum === endHourNum && startMinuteNum === endMinuteNum) {
                    // 24å°æ™‚é ç´„
                    timeSlot = isWeekend ? 'å‡æ—¥24å°æ™‚' : 'å¹³æ—¥24å°æ™‚';
                    pricePerPerson = isWeekend ? 2000 : 1850;
                    formula = `${effectivePeopleCount}*(${isWeekend ? 2000 : 1850})`;
                } else if (endHourNum >= 16 || endHourNum < 8) {
                    // è·¨æ™‚æ®µçš„æƒ…æ³
                    const dayHours = 16 - startHourNum;
                    const nightHours = endHourNum < 8 ? endHourNum + 24 - 16 : endHourNum - 16;

                    let dayPrice = 0;
                    let dayFormula = '';
                    let daySlot = isWeekend ? 'å‡æ—¥ç™½å¤©' : 'å¹³æ—¥ç™½å¤©';
                    if (dayHours <= 3) {
                        dayPrice = (isWeekend ? 390 : 360) * (dayHours / 3);
                        dayFormula = dayHours === 3 ? `(${isWeekend ? 390 : 360})` : `(${isWeekend ? 390 : 360}/3*${dayHours})`;
                        daySlot += `${dayHours}å°æ™‚`;
                    } else if (dayHours === 4) {
                        dayPrice = (isWeekend ? 390 : 360) + 80;
                        dayFormula = `(${isWeekend ? 390 : 360}+80)`;
                        daySlot += '3å°æ™‚+1å°æ™‚åŠ æ™‚';
                    } else if (dayHours === 5) {
                        dayPrice = isWeekend ? 490 : 460;
                        dayFormula = `(${isWeekend ? 490 : 460})`;
                        daySlot += '5å°æ™‚';
                    } else {
                        const overtimeHours = dayHours - 5;
                        dayPrice = (isWeekend ? 490 : 460) + overtimeHours * 80;
                        dayFormula = `(${isWeekend ? 490 : 460}+${overtimeHours === 1 ? '80' : overtimeHours + '*80'})`;
                        daySlot += `5å°æ™‚+${overtimeHours}å°æ™‚åŠ æ™‚`;
                    }

                    let nightPrice = 0;
                    let nightFormula = '';
                    let nightSlot = isWeekend ? 'å‡æ—¥ä¸­ç­' : 'å¹³æ—¥ä¸­ç­';
                    if (nightHours < 3) {
                        nightPrice = (isWeekend ? 450 : 420) * (nightHours / 3);
                        nightFormula = nightHours === 3 ? `(${isWeekend ? 450 : 420})` : `(${isWeekend ? 450 : 420}/3*${nightHours})`;
                        nightSlot += `${nightHours}å°æ™‚`;
                    } else if (nightHours === 3) {
                        nightPrice = isWeekend ? 450 : 420;
                        nightFormula = `(${isWeekend ? 450 : 420})`;
                        nightSlot += '3å°æ™‚';
                    } else if (nightHours === 4) {
                        nightPrice = (isWeekend ? 450 : 420) + 80;
                        nightFormula = `(${isWeekend ? 450 : 420}+80)`;
                        nightSlot += '3å°æ™‚+1å°æ™‚åŠ æ™‚';
                    } else if (nightHours === 5) {
                        nightPrice = isWeekend ? 620 : 600;
                        nightFormula = `(${isWeekend ? 620 : 600})`;
                        nightSlot += '5å°æ™‚';
                    } else {
                        const overtimeHours = nightHours - 5;
                        nightPrice = (isWeekend ? 620 : 600) + overtimeHours * 80;
                        nightFormula = `(${isWeekend ? 620 : 600}+${overtimeHours === 1 ? '80' : overtimeHours + '*80'})`;
                        nightSlot += `5å°æ™‚+${overtimeHours}å°æ™‚åŠ æ™‚`;
                    }

                    pricePerPerson = dayPrice + nightPrice;
                    formula = `${effectivePeopleCount}*(${dayFormula}${nightHours > 0 ? '+' + nightFormula : ''})`;
                    timeSlot = `${daySlot}${nightHours > 0 ? '+' + nightSlot : ''}`;
                } else {
                    // ç´”ç™½å¤©æ™‚æ®µ
                    timeSlot = isWeekend ? 'å‡æ—¥ç™½å¤©' : 'å¹³æ—¥ç™½å¤©';
                    if (hours <= 3) {
                        pricePerPerson = (isWeekend ? 390 : 360) * (hours / 3);
                        formula = hours === 3 ? `${effectivePeopleCount}*(${isWeekend ? 390 : 360})` : `${effectivePeopleCount}*(${isWeekend ? 390 : 360}/3*${hours})`;
                        timeSlot += `${hours}å°æ™‚`;
                    } else if (hours === 4) {
                        pricePerPerson = (isWeekend ? 390 : 360) + 80;
                        formula = `${effectivePeopleCount}*(${isWeekend ? 390 : 360}+80)`;
                        timeSlot += '3å°æ™‚+1å°æ™‚åŠ æ™‚';
                    } else if (hours === 5) {
                        pricePerPerson = isWeekend ? 490 : 460;
                        formula = `${effectivePeopleCount}*(${isWeekend ? 490 : 460})`;
                        timeSlot += '5å°æ™‚';
                    } else {
                        const overtimeHours = hours - 5;
                        pricePerPerson = (isWeekend ? 490 : 460) + overtimeHours * 80;
                        formula = `${effectivePeopleCount}*(${isWeekend ? 490 : 460}+${overtimeHours === 1 ? '80' : overtimeHours + '*80'})`;
                        timeSlot += `5å°æ™‚+${overtimeHours}å°æ™‚åŠ æ™‚`;
                    }
                }
            } else {
                // å…¶ä»–æ™‚æ®µ
                timeSlot = '';
                pricePerPerson = 0;
                formula = '';
            }

            // è¨ˆç®—ç¸½åƒ¹
            const totalAdmission = pricePerPerson * effectivePeopleCount;
            const deposit = Math.min(adultCount * 500, 3000);
            const childDeposit = childCount * 0.8 * 500;
            const finalPayment = totalAdmission + deposit + childDeposit - 500;

            // é¡¯ç¤ºçµæœ
            document.getElementById('totalPrice').textContent = finalPayment.toLocaleString();
            const timeRangeText = startYear === endYear && startMonth === endMonth && startDay === endDay
                ? `${startYear}å¹´${startMonth}æœˆ${startDay}æ—¥ ${startHour.toString().padStart(2, '0')}:${startMinute.toString().padStart(2, '0')} - ${endHour.toString().padStart(2, '0')}:${endMinute.toString().padStart(2, '0')}`
                : `${startYear}å¹´${startMonth}æœˆ${startDay}æ—¥ ${startHour.toString().padStart(2, '0')}:${startMinute.toString().padStart(2, '0')} - ${endYear}å¹´${endMonth}æœˆ${endDay}æ—¥ ${endHour.toString().padStart(2, '0')}:${endMinute.toString().padStart(2, '0')}`;
            document.getElementById('timeRange').textContent = timeRangeText;
            document.getElementById('timeSlot').textContent = timeSlot;
            document.getElementById('duration').textContent = hours;
            document.getElementById('pricePerPerson').textContent = pricePerPerson;
            document.getElementById('totalAdmission').textContent = totalAdmission.toFixed(1);
            document.getElementById('priceFormula').textContent = formula;
            document.getElementById('deposit').textContent = deposit.toLocaleString();
            document.getElementById('childDeposit').textContent = childDeposit.toLocaleString();
            document.getElementById('finalPayment').textContent = finalPayment.toFixed(1);
            document.getElementById('customerNameConfirm').textContent = document.getElementById('customerName').value + 'å…ˆç”Ÿ/å°å§';
            document.getElementById('timeRangeConfirm').textContent = startYear === endYear && startMonth === endMonth && startDay === endDay
                ? `${startMonth}/${startDay}ï¼ˆ${['æ—¥', 'ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­'][startDate.getDay()]}ï¼‰ ${startHour.toString().padStart(2, '0')}ï¼š${startMinute.toString().padStart(2, '0')} - ${endHour.toString().padStart(2, '0')}ï¼š${endMinute.toString().padStart(2, '0')}`
                : `${startMonth}/${startDay}ï¼ˆ${['æ—¥', 'ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­'][startDate.getDay()]}ï¼‰ ${startHour.toString().padStart(2, '0')}ï¼š${startMinute.toString().padStart(2, '0')} - ${endMonth}/${endDay}ï¼ˆ${['æ—¥', 'ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­'][new Date(endYear, endMonth - 1, endDay).getDay()]}ï¼‰${endHour.toString().padStart(2, '0')}ï¼š${endMinute.toString().padStart(2, '0')}`;
            document.getElementById('durationConfirm').textContent = `ï¼ˆå…±${hours}å°æ™‚ï¼‰`;
            document.getElementById('priceResult').style.display = 'block';
            document.getElementById('refundResult').style.display = 'none';
            document.getElementById('pricePerPersonConfirm').textContent = pricePerPerson.toLocaleString();
            document.getElementById('depositMinusDownConfirm').textContent = (deposit + childDeposit - 500).toLocaleString();
            document.getElementById('depositRefundConfirm').textContent = (deposit + childDeposit).toLocaleString();
            document.getElementById('reservationDateConfirm').textContent = `${startMonth}/${startDay}ï¼ˆ${['æ—¥', 'ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­'][startDate.getDay()]}ï¼‰`;
            document.getElementById('reservationTimeConfirm').textContent = `${startHour.toString().padStart(2, '0')}ï¼š${startMinute.toString().padStart(2, '0')}-${endHour.toString().padStart(2, '0')}ï¼š${endMinute.toString().padStart(2, '0')}ï¼ˆ${hours}å°æ™‚ï¼‰`;
            
            // è¨ˆç®—å¯†ç¢¼æœ‰æ•ˆæœŸçš„é–‹å§‹æ™‚é–“ï¼ˆéŠç©æ™‚é–“é–‹å§‹å‰10åˆ†é˜ï¼‰
            const passwordStartDateTime = new Date(startDateTime);
            passwordStartDateTime.setMinutes(passwordStartDateTime.getMinutes() - 10);
            document.getElementById('passwordStartTime').textContent = `${passwordStartDateTime.getFullYear()}-${(passwordStartDateTime.getMonth() + 1).toString().padStart(2, '0')}-${passwordStartDateTime.getDate().toString().padStart(2, '0')} ${passwordStartDateTime.getHours().toString().padStart(2, '0')}ï¼š${passwordStartDateTime.getMinutes().toString().padStart(2, '0')}`;
            
            // å¯†ç¢¼æœ‰æ•ˆæœŸçš„çµæŸæ™‚é–“ï¼ˆéŠç©æ™‚é–“çµæŸæ™‚é–“ï¼‰
            document.getElementById('passwordEndTime').textContent = `${endYear}-${endMonth.toString().padStart(2, '0')}-${endDay.toString().padStart(2, '0')} ${endHour.toString().padStart(2, '0')}ï¼š${endMinute.toString().padStart(2, '0')}`;

            document.getElementById('reminderPricePerPerson').textContent = pricePerPerson.toLocaleString();
            document.getElementById('reminderDepositMinusDown').textContent = (deposit + childDeposit - 500).toLocaleString();
            document.getElementById('reminderStartTime').textContent = `${startHour.toString().padStart(2, '0')}ï¼š${startMinute.toString().padStart(2, '0')}`;

            // ä¿®æ”¹é é¢æ¨™é¡Œ
            const customerName = document.getElementById('customerName').value;
            document.title = `${startMonth}/${startDay} ${startHour.toString().padStart(2, '0')}ï¼š${startMinute.toString().padStart(2, '0')} ${customerName}`;

            // åœ¨ calculatePrice å‡½æ•¸ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç¢¼
            document.getElementById('playTimeConfirm').textContent = startYear === endYear && startMonth === endMonth && startDay === endDay
                ? `âœ…éŠç©æ™‚é–“ï¼š${startYear}å¹´${startMonth}æœˆ${startDay}æ—¥ï¼ˆ${['æ—¥', 'ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­'][startDate.getDay()]}ï¼‰${startHour.toString().padStart(2, '0')}ï¼š${startMinute.toString().padStart(2, '0')}-${endHour.toString().padStart(2, '0')}ï¼š${endMinute.toString().padStart(2, '0')}`
                : `âœ…éŠç©æ™‚é–“ï¼š${startYear}å¹´${startMonth}æœˆ${startDay}æ—¥ï¼ˆ${['æ—¥', 'ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­'][startDate.getDay()]}ï¼‰${startHour.toString().padStart(2, '0')}ï¼š${startMinute.toString().padStart(2, '0')}-${endMonth}æœˆ${endDay}æ—¥ï¼ˆ${['æ—¥', 'ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­'][new Date(endYear, endMonth - 1, endDay).getDay()]}ï¼‰${endHour.toString().padStart(2, '0')}ï¼š${endMinute.toString().padStart(2, '0')}`;
        }

        // è¨ˆç®—é€€æ¬¾é‡‘é¡çš„å‡½æ•¸
        function calculateRefund() {
            const totalAdmission = parseFloat(document.getElementById('totalAdmission').textContent.replace(/,/g, ''));
            const deposit = parseFloat(document.getElementById('deposit').textContent.replace(/,/g, ''));
            const childDeposit = parseFloat(document.getElementById('childDeposit').textContent.replace(/,/g, ''));
            const discountRate = parseFloat(document.getElementById('discountRate').value);
            
            // è¨ˆç®—æŠ˜æ‰£å¾Œçš„é‡‘é¡
            const discountedAmount = Math.round(totalAdmission * discountRate);
            const discountDifference = totalAdmission - discountedAmount;
            
            // è¨ˆç®—é€€æ¬¾ç¸½é¡ï¼ˆå·®é¡ + æŠ¼é‡‘ï¼‰
            const refundAmount = discountDifference + deposit + childDeposit;
            
            // é¡¯ç¤ºçµæœ
            document.getElementById('originalAmount').textContent = totalAdmission.toLocaleString();
            document.getElementById('discountedAmount').textContent = discountedAmount.toLocaleString();
            document.getElementById('discountDifference').textContent = discountDifference.toLocaleString();
            document.getElementById('depositAndDown').textContent = (deposit + childDeposit).toLocaleString();
            document.getElementById('refundAmount').textContent = refundAmount.toLocaleString();
            
            // é¡¯ç¤ºçµæœå€å¡Š
            document.getElementById('refundResult').style.display = 'block';
        }

        // ç¢ºèªç™»è¨˜å®šé‡‘çš„å‡½æ•¸
        async function confirmDeposit() {
            const customerName = document.getElementById('customerName').value;
            const now = new Date();
            const currentDate = `${now.getFullYear()}/${now.getMonth() + 1}/${now.getDate()}`;

            try {
                await recordDeposit({
                    date: currentDate,
                    customerName: customerName
                });
                alert('å®šé‡‘è¨˜éŒ„å·²æˆåŠŸä¿å­˜');
            } catch (error) {
                console.error('è¨˜éŒ„å®šé‡‘å¤±æ•—:', error);
                alert('è¨˜éŒ„å®šé‡‘å¤±æ•—ï¼Œè«‹é‡è©¦');
            }
        }

        // ç¢ºèªç™»è¨˜å°¾æ¬¾çš„å‡½æ•¸
        async function confirmFinalPayment() {
            const customerName = document.getElementById('customerName').value;
            const now = new Date();
            const currentDate = `${now.getFullYear()}/${now.getMonth() + 1}/${now.getDate()}`;

            try {
                await recordFinalPayment({
                    date: currentDate,
                    name: customerName
                });
                alert('å°¾æ¬¾è¨˜éŒ„å·²æˆåŠŸä¿å­˜');
            } catch (error) {
                console.error('è¨˜éŒ„å°¾æ¬¾å¤±æ•—:', error);
                alert('è¨˜éŒ„å°¾æ¬¾å¤±æ•—ï¼Œè«‹é‡è©¦');
            }
        }

        // ç¢ºèªç™»è¨˜é€€æ¬¾çš„å‡½æ•¸
        async function confirmRefund() {
            try {
                const customerName = document.getElementById('customerName').value;
                const totalAdmission = parseFloat(document.getElementById('totalAdmission').textContent.replace(/,/g, ''));
                const deposit = parseFloat(document.getElementById('deposit').textContent.replace(/,/g, ''));
                const childDeposit = parseFloat(document.getElementById('childDeposit').textContent.replace(/,/g, ''));
                const discountRate = parseFloat(document.getElementById('discountRate').value);
                const now = new Date();
                const currentDate = `${now.getFullYear()}/${now.getMonth() + 1}/${now.getDate()}`;
                
                if (!customerName) {
                    alert('è«‹è¼¸å…¥å§“å');
                    return;
                }

                // è¨ˆç®—æŠ˜æ‰£å¾Œçš„é‡‘é¡å’Œå·®é¡
                const discountedAmount = Math.round(totalAdmission * discountRate);
                const discountDifference = totalAdmission - discountedAmount;
                
                // è¨ˆç®—é€€æ¬¾ç¸½é¡
                const refundAmount = discountDifference + deposit + childDeposit;

                await recordRefund({
                    name: customerName,
                    refundAmount: refundAmount,
                    date: currentDate
                });
                alert('é€€æ¬¾è¨˜éŒ„å·²æˆåŠŸä¿å­˜');
            } catch (error) {
                console.error('è¨˜éŒ„é€€æ¬¾å¤±æ•—:', error);
                alert('è¨˜éŒ„é€€æ¬¾å¤±æ•—ï¼Œè«‹é‡è©¦');
            }
        }
    </script>
    <script src="googleSheets.js"></script>
</body>
</html>